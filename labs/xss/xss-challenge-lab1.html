<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>XSS Lab Challenge</title>
  <style>
    .xxs-lab-soln-content {
      display: none;
      border: 2px dashed #4caf50;
      padding: 15px;
      margin-top: 20px;
      background: #f1fff0;
      font-family: monospace;
    }
    .b {
      background: #fff8e1;
      padding: 10px;
      border: 1px dashed #fbc02d;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <div class="b">
    <h2>XSS Lab – Easy</h2>
    <p>There's a hidden reflected XSS vulnerability on this page.<br><br><br>
      Your goal is to execute function displaySoln(secret-value)using that vulnerability and get the flag<br><br><br>
      No <i>result</i> will be shown unless it's perfect.<br><br><br>
      Hint: Secret value is the most used value <a href="https://sudohopex.github.io/">Here</a> & have min 7 letters<br>
    </p>
  </div>

  <div id="o"></div>

  <div class="xxs-lab-soln-content" id="s"></div>

  <script>
    function displaySoln(x) {
      const a = 'SuXope', b = 'dHdo', c = 'pXeXo';
      let zxd = a.substring(0,1);    
      let plm = a.charAt(1);
      let edd = a.substring(0,1);
      let edc = c.charAt(2);
      let rty = a.charAt(4);
      let vbn = zxd + plm;             
      let poi = b.charAt(0);         
      let mko = b.charAt(3);
      let bdc = [x.charAt(0), x.substring(1, 4), x.slice(4, 8), x[8]].join('');
      let zxc = rty + edc;
      let asd = c.charAt(3)
      let lkj = poi + mko;         
      let nbh = a.charAt(3);
      let zcx = rty + edc;
      let uyt = b.charAt(1);       
      let fgh = uyt + nbh;
      if (bdc === [vbn, lkj, fgh, zxc, asd].join('')) {
        const f = b.charAt(2) + a.charAt(1) + 'X-' + x.slice(0, 2).toLowerCase() + x.length + '-' + x.charCodeAt(2);
        document.getElementById('s').style.display = 'block';
        document.getElementById('s').innerHTML = `<h3>✅ Challenge Solved</h3>
          <p>You executed <code>displaySoln()</code> with the correct secret.</p>
          <p>Flag: <code>${f}</code></p>`;
      }
    }

    (function(){
      let u = location + '';
      let x = '', m;
      try {
        x = decodeURIComponent((u.split('?')[1] || '').replace(/^result=/, ''));
      } catch(e) {}

      const fn = 'displaySoln';
      const re = new RegExp('^' + fn + '\\(([^\\)]+)\\)$');
      m = x.match(re);

      if (m && typeof window[fn] === 'function') {
        window[fn](m[1]);
      } else if (x) {
        document.getElementById('o').innerHTML = '<p style="color:yellow;font-weight:bold; margin-top:300px;">are you here?</p>';
      }
    })();
  </script>
</body>
</html>
